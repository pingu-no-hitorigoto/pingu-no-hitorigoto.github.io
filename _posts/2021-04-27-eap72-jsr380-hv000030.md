---
layout    : post
category  : ãƒ†ã‚¯
title     : No validator could be found on JBoss EAP 7.2
tags      : [springboot, jboss]
date      : 2021-04-27 14:28:00 +8
last_modified_at: 2021-05-03 17:28:00 +8
published : true
lang      : zh-TW
reference : [
    'https://docs.wildfly.org/13/Getting_Started_Guide.html#ee8-preview',
    'https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform_continuous_delivery/14/html-single/jboss_eap_continuous_delivery_14_release_notes/index#java_ee_8',
    'https://pdffox.com/red-hat-jboss-enterprise-application-platform-72beta-72-beta-release-notes-pdf-free.html'
]
---

æœ€è¿‘è™•ç†åˆ°ä¸€å€‹å•é¡Œï¼Œæ˜æ˜æ‡‰ç”¨ç¨‹å¼çš„ç›¸ä¾é—œä¿‚å®Œæ•´ä¸”ä»¥SpringBootåŸ·è¡Œæ­£å¸¸ï¼Œä½†æ˜¯ä¸€ä½ˆç½²åˆ°JBoss EAP 7.2åŸ·è¡Œå°±ç™¼ç”ŸéŒ¯èª¤ï¼
è€Œä¸”å±…ç„¶æ˜¯`HV000030`æ‰¾ä¸åˆ°å¯ç”¨Validatorï¼Ÿ

<!--more-->

> *2021-05-03æ›´æ–°*  
åœ¨äº‹å¾Œçš„ç³»çµ±æ›´æ–°ç™¼ç¾é–‹ç™¼ç’°å¢ƒèˆ‡æ¸¬è©¦ç’°å¢ƒçš„JBoss EAPç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œ
ç™¼ç”Ÿå•é¡Œçš„å®Œæ•´ç‰ˆæœ¬è™Ÿæ˜¯JBoss EAP 7.2.0.__*Beta*__......æ˜¯å“ªå€‹æ··å¸³æŠŠé€™ç•¶å‚³å®¶å¯¶çš„ï¼ˆæ€’  
æ‰€ä»¥å…¶å¯¦æ˜¯æˆ‘çš„èª¤æœƒï¼ŒRed Hatçš„æ–‡ä»¶ä¸¦æ²’èªªéŒ¯ã€‚

## äº‹ä»¶ç¶“é

ç›®å‰å·¥ä½œåœ¨é–‹ç™¼è¦ä½ˆç½²åˆ°JBoss EAP 7.2ä¸Šçš„æ‡‰ç”¨ç¨‹å¼ï¼Œå…¶ä¸­ä½¿ç”¨JSR-380é€²è¡Œè³‡æ–™é©—è­‰ã€‚
ç›¸é—œç¨‹å¼ä»¥SpringBootç›´æ¥å•Ÿå‹•æ²’æœ‰å•é¡Œï¼Œä½†ä½ˆç½²åˆ°EAPä¹‹å¾Œå»ç™¼ç”Ÿç„¡æ³•é©—è­‰çš„å•é¡Œã€‚

```text
...
javax.validation.UnexpectedTypeException: HV000030:
  No validator could be found for constraint 'javax.validation.constraints.NotBlank'
  validating type 'java.lang.String'. Check configuration for 'example.value'
    at o.h.v.i.e.c.ConstraintTree.throwExceptionForNullValidator(ConstraintTree.java:229)
    at o.h.v.i.e.c.ConstraintTree.getConstraintValidatorNoUnwrapping(ConstraintTree.java:310)
    at o.h.v.i.e.c.ConstraintTree.getConstraintValidatorInstanceForAutomaticUnwrapping(ConstraintTree.java:244)
    at o.h.v.i.e.c.ConstraintTree.getInitializedConstraintValidator(ConstraintTree.java:163)
    at o.h.v.i.e.c.ConstraintTree.validateConstraints(ConstraintTree.java:116)
    at o.h.v.i.e.c.ConstraintTree.validateConstraints(ConstraintTree.java:87)
    at o.h.v.i.m.c.MetaConstraint.validateConstraint(MetaConstraint.java:73)
    at o.h.v.i.e.ValidatorImpl.validateConstraintsForGroup(ValidatorImpl.java:1469)
    at o.h.v.i.e.ValidatorImpl.validateParametersForSingleGroup(ValidatorImpl.java:1260)
    at o.h.v.i.e.ValidatorImpl.validateParametersForGroup(ValidatorImpl.java:1189)
    at o.h.v.i.e.ValidatorImpl.validateParametersInContext(ValidatorImpl.java:1109)
    at o.h.v.i.e.ValidatorImpl.validateParameters(ValidatorImpl.java:302)
    at o.h.v.i.e.ValidatorImpl.validateParameters(ValidatorImpl.java:256)
    at o.s.v.b.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:105)
...
```

## è§£æ

JBoss EAPæœƒä¸»å‹•ç‚ºä½ˆç½²çš„æ‡‰ç”¨ç¨‹å¼[æ·»åŠ æ¨¡çµ„][Implicit Module Dependencies]ï¼Œä¸”é€™äº›æ¨¡çµ„æœ‰æ›´é«˜çš„å„ªå…ˆåºï¼Œ
æ•…åŸ·è¡ŒæœŸé–“å¯¦éš›ä½¿ç”¨çš„å¥—ä»¶ä¸æ˜¯ç”±`spring-boot-starter-validation`æä¾›ã€è€Œæ˜¯JBossæ³¨å…¥çš„ç‰ˆæœ¬ã€‚

æœ¬ä¾†é€™æ‡‰è©²ä¸æ˜¯å•é¡Œï¼Œ`NotBlank`æ˜¯åœ¨JSR-380æ–°å¢çš„é©—è­‰è¦å‰‡ï¼Œè€ŒJSR-380åˆåœ¨EE 8çš„è¦æ ¼å…§ï¼Œç†è«–ä¸Šæ”¯æ´EE 8çš„EAP 7.2æ‡‰è©²èƒ½æ­£å¸¸é‹ä½œæ‰æ˜¯ã€‚
ä½†å¯¦éš›è¿½æº¯JBoss EAPæä¾›çš„æ¨¡çµ„å®šç¾©å¯ä»¥ç™¼ç¾`javax.validation.api`åŒæ™‚å­˜åœ¨1.1å’Œ2.0å…©å€‹ç‰ˆæœ¬ï¼Œè€Œä¸”é‚„æœ‰ä¸€å€‹åƒæ•¸`ee8.preview.mode`åœ¨æ±ºå®šç”±èª°å‡ºå ´ã€‚

```text
...
14:07:52,084 INFO  [org.jboss.as.ee] (ServerService Thread Pool -- 41) WFLYEE0119:
  The system property 'ee8.preview.mode' is NOT set to 'true'. For provided EE 8
  APIs where the EE 8 version of the API differs from what is supported in EE 7,
  the EE 7 variant of the API will be used. Support for this setting will be removed
  once all EE 8 APIs are provided and certified.
...
```

æ‰“æ’ˆå•Ÿå‹•éšæ®µçš„è¼¸å‡ºå¯ä»¥ç™¼ç¾ä»¥ä¸Šè¨Šæ¯ã€‚
å…¶å¯¦JBoss EAPæ—©åœ¨å•Ÿå‹•çš„æ™‚å€™ä¾¿å·²èªªæ˜å¦‚è¦ä½¿ç”¨EE 8çš„åŠŸèƒ½éœ€è¦å°‡`ee8.preview.mode`è¨­å®šç‚ºtrueï¼Œå¦å‰‡åœ¨æ­£å¼ç™¼å¸ƒä»¥å‰ä»æœƒå„ªå…ˆæä¾›EE 7ã€‚

è€ŒEE 7çš„Bean Validationåªæœ‰1.1ã€‚

```sh
/system-property=ee8.preview.mode:add(value=true)
```

åŸ·è¡Œä»¥ä¸ŠæŒ‡ä»¤ä¸¦é‡å•ŸJBoss EAPï¼Œè©²å•é¡Œé †åˆ©è§£æ±ºã€‚

## çµè«–

ç¿»éJBoss EAP 7.2çš„æ–‡ä»¶æ‰¾ä¸åˆ°é—œæ–¼é€™å€‹åƒæ•¸çš„éš»å­—ç‰‡èªï¼Œåƒ…åœ¨é—œè¯ç”¢å“[EAP 7.2-beta]å’Œ[EAP CD 14]çš„ç™¼è¡Œå‚™è¨»æ‰¾åˆ°çŸ­çŸ­ä¸€è¡Œèªªæ˜ï¼Œ
åè€Œæ˜¯JBoss EAPçš„ä¸Šæ¸¸å°ˆæ¡ˆWildFlyç›´æ¥[çµ¦ä»–ä¸€å€‹ç« ç¯€][WildFly13 Getting Started]ã€‚è³£æœå‹™çš„Red Hatçš„é–‹æºæ–¹æ¡ˆé‚„çœŸå«äººå®‰å¿ƒğŸ™„

[WildFly13 Getting Started]: https://docs.wildfly.org/13/Getting_Started_Guide.html#ee8-preview
[Implicit Module Dependencies]: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html/development_guide/class_loading_and_modules#implicit_module_dependencies
[EAP CD 14]: https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform_continuous_delivery/14/html-single/jboss_eap_continuous_delivery_14_release_notes/index#java_ee_8
[EAP 7.2-beta]: https://pdffox.com/red-hat-jboss-enterprise-application-platform-72beta-72-beta-release-notes-pdf-free.html
